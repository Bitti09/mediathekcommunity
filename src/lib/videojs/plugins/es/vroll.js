/**
 * Copyright (c) 2023 The Nuevodevel Team. All rights reserved.
 * Vroll plugin for video.js
 * Version 1.4.0
 */
/* eslint-disable */import videojs from"video.js";function vrollInit(e,t,i){var r=null;if(i)if(i.trackUrl)r=i.trackUrl;var n,o=[],l=!1,s=!1,a=!1,f=!1,d=!1,u=!1,c=!1,v=!1,p="undefined",m=-1,h=0,y=0,g=e.$(".vjs-tech");videojs.isAd=!1;var j,b=videojs.dom,k=e.el(),T=.1,C=videojs.browser,S=null,A=null,x=[],_=null,I=null,O=null;videojs.vrollplugin=!0;function P(e){return e}function q(e){return"[object Array]"===Object.prototype.toString.call(e)}var N=function(e,t){var i=document.createElement(e);if(void 0!==t)if(""!==t)i.className=t;return i},E=function(t){return e.localize(t)};function M(){if(e.duration()===1/0)return!0;else if("8"===C.IOS_VERSION&&0===e.duration())return!0;return!1}var w=!0;if(!q(t)){var H=t;if(H.src)if(H.src.length>5){if(H.offset){if(H.offset.indexOf("%")>-1)if(M())w=!1}else H.offset=0;if(w)(t=[])[0]=H}}if(q(t))for(var L=0,B=0;B<t.length;B++){var F=t[B];if(F.src&&"undefined"!==F.offset){F.loaded=!1;L=0;try{L=o[B].offset.indexOf("%")}catch(e){P(e)}if(L>0&&M())L=1;else o.push(F)}}function Q(){if(e.el_.className.indexOf("vjs-casting")>0)return!0;else return!1}e.ready(function(){I=e.el_.querySelector(".vjs-loading-spinner");var t=e.el_.querySelector(".vjs-big-play-button");A=e.el_.querySelector(".vjs-replay-button");if(o.length>0){n=N("a","vast-blocker vjs-hidden");e.el_.appendChild(n);function i(e){var t=e.el().querySelector(".vjs-tech"),i={ended:e.ended(),src:e.currentSrc(),currentTime:e.currentTime(),type:e.currentType(),currentSource:e.currentSource(),playing:!e.paused(),suppressedTracks:C(e)};if(i.ended)i.currentTime=e.duration();if(t)i.style=t.getAttribute("style");return i}function C(e){var t=e.remoteTextTracks?e.remoteTextTracks():[];if(t&&q(t.tracks_))t=t.tracks_;if(!q(t))t=[];var i=[];t.forEach(function(e){i.push({track:e,mode:e.mode});e.mode="disabled"});return i}function w(){O.suppressedTracks.forEach(function(e){e.track.mode=e.mode})}function H(e){var t=e.el().querySelector(".vjs-tech");if("style"in O)t.setAttribute("style",O.style||"");e.one("contentloadedmetadata",w);function i(){if(M())L();else{L();e.currentTime(O.currentTime)}}t.poster="";e.src(O.currentSource);e.load();w();i()}function L(){var t=e.play();if(void 0!==t)t.then(function(){}).catch(function(){e.muted(!0);e.play()})}e.vroll.reset=function(){u=!1;f=!1;b.removeClass(k,"vjs-ad-playing");e.one("playing",function(){for(var e=0;e<o.length;e++)o[e].loaded=!1})};for(var B=0;B<o.length;B++)if(!o[B].offset)o[B].offset=0;if(0===parseInt(o[0].offset,10))if(e.offline)e.isPreroll=!1;else{e.isPreroll=!0;if(!0!==v){v=!0;y=e.volume()}e.one("play",function(){if(e.isPreroll){var t=e.el_.querySelector(".vjs-poster");S=N("div","vjs-black-poster");k.insertBefore(S,t.nextSibling);e.isPreroll=!1}})}e.on("loadedmetadata",function(){if(!e.isOffline){if(!u){u=!0;if(!0!==s)var C=e.duration();if(o.length>0&&!0!==d){d=!0;for(var q=0;q<o.length;q++){o[q].method="";if(!s){var w=0;try{w=o[q].offset.indexOf("%",0)}catch(e){P(e)}if(w>0){var L=parseInt(o[q].offset,10);if(100===L||"end"===o[q].offset){o[q].method="postroll";o[q].offset="end";x.push(o[q])}else o[q].offset=C*(L/100)}else o[q].offset=parseInt(o[q].offset,10)}}}var B;if(o.length>0){e.on("timeupdate",B);function B(){if(o[o.length-1].loaded)e.off("timeupdate",B);var t=videojs.dom.hasClass(k,"vjs-has-started"),i=M();if(t&&!0!==a&&!0!==e.isOffline&&!0!==i)J(e.currentTime())}function F(){if(a){clearTimeout(h);c=!1}else{J(T+=.5);h=setTimeout(F,500)}}if(M()){e.on("pause",function(){clearTimeout(h);c=!1});e.on("playing",function(){if(videojs.dom.hasClass(k,"vjs-has-started")&&!0!==l&&o.length>0&&!0!==e.isOffline&&!0!==c){c=!0;h=setTimeout(F,500)}})}function U(){b.addClass(A,"vjs-hidden")}function z(t){if(!l){if(null!==x){if(!O)O=i(e);I.setAttribute("style","display:none !important");for(var r=0;r<x.length;r++)if(!0!==x[r].loaded){e.trigger("vroll",{id:p.id,action:"completed"});ie("completed");if(!O)O=i(e);R();return}}e.trigger("vroll",{id:p.id,action:"completed"});ie("completed");V(!0);e.off("ended",z);setTimeout(function(){b.removeClass(A,"vjs-hidden")},500);D()}else{e.trigger("vroll",{id:p.id,action:"completed"});ie("completed");X()}}function D(){if(e.playlist)if(e.playlist.length>0){e.pause();e.playlist.next(!0)}}e.on("ended",z);e.one("play",U);function R(){for(var t=0;t<x.length;t++)if(!0!==x[t].loaded){$(x[t]);return}V();H(e,O)}function V(t){e.off("timeupdate",le);e.off("error",oe);n.className="vjs-blocker vjs-hidden";if(t){x=null;re(".vast-blocker")}l=!1;f=!1;a=!1;re(".vast-skip-button");setTimeout(function(){I.removeAttribute("style")},500);b.addClass(k,"vjs-has-started");g.poster="";b.removeClass(k,"vjs-ad-playing");videojs.isAd=!1}function $(t){t.loaded=!0;p=t;a=!0;videojs.isAd=!0;b.addClass(k,"vjs-ad-playing");f=!0;e.on("error",oe);var i={src:t.src,type:t.type};e.src(i);I.setAttribute("style","display:none !important");e.play();e.one("play",function(){se()})}function G(t,r){l=!0;t.loaded=!0;if(!Q()){p=t;f=!0;var n={src:t.src,type:t.type};if(!O)O=i(e);I.setAttribute("style","display:none !important");e.one("error",oe);e.src(n);e.currentTime(0);if(!e.paused()){se();var o=e.play();if(void 0!==o)o.then(function(){}).catch(function(e){})}else{var s=!1;if(e.el_.className.indexOf("vjs-has-started")>0)s=!0;if(e.ended()||s)e.play();if(e.ended())e.play();e.one("play",function(){se()})}}}if(e.isPreroll){if(!0!==v){v=!0;y=e.volume();e.volume(0)}if(!0!==M())G(o[0])}function J(t){if(!l&&!a){var i=t;if(i>0)e.el_.querySelector(".vjs-poster").removeAttribute("style");for(var r=0;r<o.length;r++){var n=o[r];if(i>=n.offset)if(!0!==l&&!0!==o[r].loaded){videojs.log.level("off");if(!0!==Q())G(n);else o[r].loaded=!0}}}}n.onclick=function(){e.trigger("vroll",{id:p.id,action:"clicked"});ie("click")};e.on("chromecastConnected",function(){K()});function K(){if(e.isPreroll){o[0].cancelled=!0;re(".vast-skip-button");_=null;m=-1;e.off("play",se);o[0].loaded=!0;e.isPreroll=!1;b.addClass(k,"vjs-has-started");b.removeClass(k,"vjs-ad-playing");e.off("timeupdate",le);e.off("error",oe);H(e,O);O=null}}function W(){return e.paused()}function X(){re(".vast-skip-button");_=null;m=-1;var t=p.offset;p.loaded=!0;e.isPreroll=!1;var i=!1;b.addClass(k,"vjs-has-started");for(var r=0;r<o.length;r++){if(o[r].offset===t&&!0!==o[r].loaded){e.off("timeupdate",le);e.off("error",oe);l=!0;a=!0;o[r].loaded=!0;videojs.isAd=!0;b.addClass(k,"vjs-ad-playing");f=!0;G(o[r],!0);i=!0}if(i)break}if(!0!==i){var n=!0;for(r=0;r<o.length;r++)if(!0!==o[r].loaded)n=!1;e.off("timeupdate",le);e.off("error",oe);V(n);H(e,O);O=null}}var Y,Z,ee=!1;function te(t){t=e.currentTime();var i=e.duration();if(i>0){var r=((i=i.toFixed(0))/4).toFixed(0);if(t>r&&!0!==Y){ie("fistQuartile");Y=!0}if(t>2*r&&!0!==Z){ie("midpoint");Z=!0}if(t>3*r&&!0!==ee){ie("thirdQuartile");ee=!0}if(m>-1){var n=Math.ceil(m-t);b.removeClass(_,"vjs-hidden");if(n>0){var o=E("Skip Ad in %%TIME%%");_.innerHTML="";N("p","vast-skip-button-text");_.appendChild(j);j.innerHTML=o.replace("%%TIME%%",n)}else{_.className="vast-skip-button enabled";_.innerHTML=E("Skip Ad")}}}}function ie(e,t){if(r){var i=new Image,n="?event="+e;if(p.id)n=n+"&id="+p.id;i.src=r+n}}function re(t){var i=e.el_.querySelectorAll(t);if(i)for(var r=0;r<i.length;r++)i[r].parentNode.removeChild(i[r])}function ne(){re(".vast-skip-button");(_=N("div","vast-skip-button vjs-hidden")).id="adSkipButton";_.ariaDisabled="false";_.tabIndex="0";j=N("p","vast-skip-button-text");_.appendChild(j);e.el_.appendChild(_);_.onclick=function(e){t(e)};function t(t){t.stopPropagation();if((" "+_.className+" ").indexOf(" enabled ")>=0){e.trigger("vroll",{id:p.id,action:"skipped"});ie("skipped");if("postroll"===p.method)R();else X()}}}function oe(){if(l){e.trigger("vroll",{id:p.id,action:"error"});ie("error");if("postroll"===p.method)R();else X();f=!1}}function le(){if(!W())te(e.currentTime(),e.duration())}function se(){if(!Q())if(!p.cancelled){e.currentTime(0);e.on("timeupdate",le);if(p.offset>0)b.addClass(t,"vjs-hidden");if(p.skip>=0)m=parseInt(p.skip,10);else m=-1;if(m>-1)ne();b.addClass(k,"vjs-ad-playing");b.addClass(t,"vjs-hidden");if(S){k.removeChild(S);S=null;e.volume(y)}e.el_.querySelector(".vjs-poster").removeAttribute("style");n.className="vast-blocker";if(void 0!==p.href){n.removeAttribute("style");n.href=p.href;n.target="_blank"}else n.style.pointerEvents="none";a=!0;if(f){e.trigger("vroll",{id:p.id,action:"start"});ie("adstart");f=!1}}}}}}else u=!1})}})}var vroll=function(e){this.ready(function(){vrollInit(this,e)})};if("undefined"!=typeof window)videojs.registerPlugin("vroll",vroll);export default vroll;
